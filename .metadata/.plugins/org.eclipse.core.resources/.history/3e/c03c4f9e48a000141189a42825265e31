#include "DriveSystem.h"
#include "math.h"

DriveSystem::DriveSystem(){

	stick  = new Joystick(0);
	stickTwo = new Joystick(1);
	talOneEnco = new Encoder(2, 3);
	talTwoEnco = new Encoder(0, 1, true); //Reverse one of these
	talZero = new Talon(0);
	talOne = new Talon(1);
	talTwo = new Talon(2);
	talThree = new Talon(3);
	drive = new RobotDrive(talTwo, talThree, talOne, talZero);
	//dash = NULL;
	dash->init();
	drive->SetInvertedMotor(RobotDrive::kFrontRightMotor, true);
	drive->SetInvertedMotor(RobotDrive::kRearRightMotor, true);
}

DriveSystem::~DriveSystem(){

	delete stick;
	delete stickTwo;
	delete talOneEnco;
	delete talTwoEnco;
	delete talZero;
	delete talOne;
	delete talTwo;
	delete talThree;
	delete drive;


}

void DriveSystem::DriveArcadeStyle(){



}

void DriveSystem::DriveMecanumStyle(){

	//talZeroSpeed = talZero->GetSpeed();


	//talThreeSpeed = talThree->GetSpeed();

	sReadX = stick->GetX();
	sReadY = stick->GetY();
	sReadZ = stick->GetZ();

	eReadOne = talTwoEnco->GetRate();
	eReadTwo = talOneEnco->GetRate();

	talValYExp = pow(sReadY, 5);
	talValXExp = pow(sReadX, 5);
	talValZExp = pow(sReadZ, 5);

	double xPrint = static_cast<float>(sReadX);
	double yPrint = static_cast<float>(sReadY);
	double zPrint = static_cast<float>(sReadZ);
	double deRead = static_cast<int>(eReadOne);
	double deReadTwo = static_cast<int>(eReadTwo);

	dash->PutNumber("X", xPrint);
	dash->PutNumber("Y", yPrint);
	dash->PutNumber("Z", zPrint);
	dash->PutNumber("encoval",deRead);
	dash->PutNumber("encovaltwo",deReadTwo);

	//drive->MecanumDrive_Cartesian(stick->GetX(), stick->GetY(), stick->GetZ());


	if((sReadX <= 0.5 && sReadX >= -0.5) && (sReadY <= 0.5 && sReadY >= -0.5)&& (sReadZ <= 0.5 && sReadZ >= -0.5)){

		drive->StopMotor();

	}

	else if((sReadX <= 0.5 || sReadX >= -0.5) && (sReadY >= 0.5 && sReadY <= -0.5) && (sReadZ <= 0.5 || sReadZ >= -0.5)){

		drive->MecanumDrive_Cartesian(0.0, talValYExp, 0.0);

		if(eReadOne < eReadTwo){

			for(talTwoSpeed = sReadY; eReadTwo > eReadOne; talTwoSpeed-0.01){
				talTwo->Set(talTwoSpeed);
			}

		}

		else if(eReadOne > eReadTwo){

			for(talOneSpeed = sReadY; eReadOne > eReadTwo; talOneSpeed-0.01){
				talOne->Set(talOneSpeed);
			}

		}

		else{

		}



	}

	else{
		drive->MecanumDrive_Cartesian(talValXExp, talValYExp, talValZExp);
	}

	//&& (sReadZ <= 0.25 && sReadZ >= -0.25)

}

void DriveSystem::DriveTankStyle(){

}

